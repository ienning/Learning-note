[TOC]

# 6. 图像处理

## 6.1 线性滤波：方框滤波，均值滤波，高斯滤波

### 6.1.1 噪声消除

消除噪声一般是平滑处理和滤波操作

### 6.1.2 方框滤波

方框滤波的卷积核内的值都是为1

### 6.1.3 均值滤波

均值滤波的卷积核内部是方框滤波的卷积核归一化后的结果，就是1/(kernel.size)

### 6.1.4 高斯滤波

高斯滤波是通过正态分布的方式，设定卷积核中的每个系数，可以设置X和Y方向的sigma参数，调整分布的幅度或者说宽度。

## 6.2 非线性滤波：中值滤波，双边滤波

### 6.2.1 非线性滤波概述

线性滤波是每个输出像素都是几个输入像素的加权和，好处是简单，但是不会去除噪声像素，只是变得柔和。而非线性滤波不是通过简单的加权和

### 6.2.2 中值滤波

中值滤波通过目标像素中邻近点的中值，通过这样消除噪音，如果是奇数个点，那么取中间值，如果是偶数个点，取中间两个中值求平均得到

### 6.2.3 双边滤波

双边滤波是结合图像的空间邻近度和像素值相似度的一种这种处理。比高斯滤波多了一个高斯方差sigma-d，是基于空间分布的高斯滤波函数，所以再边缘附近，离的较远的像素不会对边缘上的像素值影响太多。保证了边缘附近像素值的保存。对彩色图像中的高频噪声，双边滤波器不能够干净地过滤，只能对低频信息进行较好地滤波。

## 6.3 图像处理形态学：腐蚀，膨胀，开运算，闭运算，形态学梯度，顶帽，黑帽

### 6.3.1 形态学概述

数学形态学是一门建立在格伦和拓扑学基础之上的图像分析学科，是数学形态学图像处理的基本理论。

### 6.3.2 腐蚀

腐蚀和膨胀是对白色区域进行的操作。

### 6.3.3 膨胀

### 6.3.4 开运算

先腐蚀和膨胀：用于消除小物体，以及对较大物体进行平滑处理且不改变其面积。

### 6.3.5 闭运算

先膨胀后腐蚀：用于排除小型黑洞。

### 6.3.6 形态学梯度

膨胀图和腐蚀图之差，用于突出轮廓边缘

### 6.3.7 顶帽

原图像和开运算之差：得到的效果图突出了比原图轮廓周围的区域更明亮的区域，且和这一操作与选择的核的大小相关

### 6.3.8 黑帽

闭运算和原图像之差：黑帽运算后的效果图突出了比原图轮廓周围的区域更暗区域

## 6.4 漫水填充

填充指定的颜色

## 6.5 图像缩放

主要使用resize，可以设定x和y方向的比例系数以及目标图像的大小



## 6.6 图像金字塔

上采样和下采样；

下采样使用的高斯金字塔

拉普拉斯金字塔：用于获取采样过程中丢失的信息，预测残差

resize：再放大的时候通过使用插值的方式填充

## 6.7 阈值化 

阈值化主要是对灰度图进行二值化，一般是两个API，一个是自己指定的，一个是自适应。

## 6.8 总结

![chapter6](.\src\chapter6.png)

# 7. 图像变换

## 7.1 基于OpenCV的边缘检测

### 7.1.1 边缘检测的一般步骤

1. 滤波：边缘检测主要基于图像的一阶和二阶导数，但是导数对噪声很敏感，所以要通过滤波器来改善，主要是使用高斯滤波
2. 增强：将图像灰度点领域值有显著变化的的点凸显出来。可用计算梯度幅值确定。
3. 检测：有些点梯度值比较大，不是要找的边缘点，可以采用阈值化的方法来检测

### 7.1.2 canny边缘检测

特点：

- 低错误率：标识出尽可能多的实际边缘，同时尽可能地减少噪音产生的误报。
- 高定位性：标识出的边缘与图像中的实际边缘尽可能接近。
- 最小响应：图像中的边缘只能标识一次，并且可能存在的图像噪声不应标识为边缘。

步骤：

1. 消除噪声：一般使用高斯平滑滤波器卷积降噪。
2. 计算梯度幅值和方向：按照Sobel滤波器的步骤来操作，一对卷积阵列分别作用X和Y方向，Gx和Gy，然后它们各自平方之和再开根以及再计算arctan(Gy/Gx)得到角度
3. 非极大值抑制：排除边缘像素，仅保留一些细线条
4. 滞后阈值：
   1. 采用双阈值，高阈值和低阈值
   2. 大于高阈值的像素保留，小于低阈值的像素被排除，再高阈值和低阈值之间的像素，如果有和大于高阈值的像素连接，那么也会被保留，反之排除。

### 7.1.3 sobel算子

介绍：

sobel主要用于边缘检测的离散微分算子。结合了高斯平滑和微分求导，用来计算图像灰度函数的近似梯度。在图像任何一点使用此算子，都将会产生对应的梯度矢量或者是其法矢量

步骤：

1. 在X和Y方向分别卷积得到Gx和Gy
   $$
   G_x =  \begin{bmatrix} 
   					   -1 & 0 & +1 \\
   					   -2 & 0 & +2 \\
   					   -1 & 0 & +1 \\
   		\end{bmatrix} * I
   \\G_y = \begin{bmatrix} 
   					   -1 & -2 & +1 \\
   					    0 &  0 &  0 \\
   					   +1 & +2 & +1 \\
   		\end{bmatrix} * I
   $$
   

2. $$
   \sqrt{G^2_x+G^2_y}
   $$

   使用上面公式获得近似梯度

### 7.1.4 Laplacian 算子

介绍：

Laplacian算子是n维欧几里得空间中的一个二阶微分算子，定义为梯度grad的散度div

步骤：

### 7.1.5 scharr滤波器

介绍：

scharr为滤波器，不是算子，一般配合sobel算子使用，Scharr滤波器计算x或y方向的图像差分。

步骤：

## 7.2霍夫变换

### 7.2.1 简介

霍夫变换是图像处理中的一种特征提取技术，该过程在一个参数空间中通过计算累计结果的局部最大值得到一个符合该特定形状的集合作为霍夫变换结果。用于检测直线，扩展后可以检测圆和椭圆

- 标准霍夫变换：HoughLines函数
- 多尺度霍夫变换：HoughLines函数
- 累积概率霍夫变换：HoughLinesP函数

## 7.3 重映射

## 7.4 仿射变换

## 7.5 直方图均衡化

