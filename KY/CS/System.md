[TOC]

# 操作系统

## 第1章 计算机系统概述

### 1.1 操作系统的基本概念

#### 1.1.1 操作系统的概念

操作系统是计算机系统中最基本的系统软件。操作系统是控制和管理整个计算机系统的硬件与软件资源，合理地组织/调度计算机的工作和资源的分配，进而为用户和其它软件提供方便接口与环境的程序集合。

#### 1.1.2 操作系统的特征

**1. 并发**

并发是，两个或多个事件同一时间间隔发生。操作系统引入进程的目的是为了使程序并发执行。

**2. 共享**

即资源共享，是指操作系统中的资源能够共享给并发执行的进程共同使用。共享一般分为两种：

1. 互斥共享
   - 像打印机，磁带机这些，虽然可以提供给多个进程使用，但是再一段时间内只能让一个进程使用，不然打印或者记录时候，同时写入会造成混淆。
2. 同时访问共享
   - 同时访问共享通常一个请求分几个时间片段间隔地完成，其效果与连续完成的效果相同。

**3. 虚拟**

虚拟是指把一个物理上实体变为若干逻辑上的对应物。例如可以利用多道程序设计技术把一个物理上的CPU虚拟为多个逻辑上的CPU，成为虚拟处理器。

**4. 异步**

多道程序环境允许多个程序并发执行，但由于资源有限，进程的执行并不是一贯到底的，而是走走停停的，它以不可预知的速度向前推进，这就是程序的异步性。

#### 1.1.3 操作系统的目标和功能

目的：给多道程序提供良好的运行环境，还需要为用户提供接口，和可以扩充机器提升利用率。

**给多道程序提供良好的运行环境**

功能：处理及管理、存储器管理、设备管理和文件管理

**还需要为用户提供接口**

功能：分类命令接口和系统调用

- 命令接口：根据作业不同：
  - 联机命令接口
  - 脱机命令接口
- 系统调用

**可以扩充机器**



#### 1.1.4 习题

**1. 选择题**

- 1-5：CDDDB
- 6-10：CBBCA
- 11-15：AA~~C~~D**C**D
- 16-18：DAD

### 1.2 操作系统的特征

#### 1.2.1 手工操作阶段（此阶段无操作系统）

 突出缺点：

1. 用户独占全机，资源利用率低
2. CPU等待手工操作，CPU利用不充分。

#### 1.2.2 批处理阶段（操作系统开始出现）

1. 单道批处理系统
   - 自动性
   - 顺序性
   - 单道性
2. 多道批处理系统：多道、宏观上并行、微观上串行

#### 1.2.3 分时操作系统

分时操作系统是指多个用户通过终端同时共享一台主机，这些终端连接在主机上，用户可以同时与主机进行交互操作而互不干扰。

- 同时性：多个终端用户同时使用一台计算机
- 交互性：
- 独立性：用户独立操作，互不干扰
- 及时性：用户请求能在很短时间内获得响应

#### 1.2.4 实时操作系统

为了能再某个时间限制内完成某些紧急任务而不需要时间片排队，诞生了实时操作系统。

#### 1.2.5 网络操作系统和分布式计算机系统

网络操作系统把计算机网络的各台计算机有机地结合起来。

分布式计算机系统由多台计算机组成并满足下列条件：

1. 系统中任意两台计算通过通信方式交换信息。
2. 系统中每台计算机都有相同地位，没有主从之分
3. 每台计算机资源为所有用户共享
4. 系统中任意台计算机都可以构成一个子系统，并且还能重构。
5. 任何工作都能分布在机台计算机上，由它们并行工作、协同完成。

#### 1.2.6 个人计算机操作系统

个人计算机操作系统是目前使用最广泛地操作系统，它广泛应用于文字处理、电子表格、游戏中，比如Windows、Linux和Macintosh等。

#### 1.2.7 习题

**1. 选择题**

- 1-5：DDCBB
- 6-10：CBDCB
- 11-16：CBBACDAD~~B~~C

### 1.3 操作系统的目标和功能

#### 1.3.1 处理器运行模式

CPU执行两种不同性质地程序：

1. 操作系统内核程序
2. 用户自编程序

操作系统内核功能包括：

**1.时钟管理**

时钟是最重要的设备。

功能：

1. 计时，通过时钟管理为用户提供给标准的系统时间
2. 通过时钟中断的管理，可以实现进程的切换
   1. 分时操作系统采用时间片轮转调度
   2. 实施系统按照截止时间控制运行
   3. 批处理系统中，通过时钟管理衡量一个作业的运行程度等。

**2. 中断机制**

初衷是提高多道程序运行环境中CPU的利用率。逐步发展后成为操作系统各项操作的基础。

**3. 原语**

按层次设计的操作系统，底层必然是一些可被调用的公用小程序，它们各自完成一个规定的操作。特点如下：

1. 处于操作系统的最底层，最接近硬件的部分
2. 具有原子性，操作只能一气呵成
3. 运行时间段，调用频繁

定义原语的直接方法是关闭中断。

**4. 系统控制的数据结构及处理**

系统中用来登记状态信息的数据结构很多，比如作业控制块、进程控制块（PCB）、设备控制块、各类链表、消息队列、缓冲区、空闲区登记表、内存分配表等。为了有效管理，常见的三种操作：

1. 进程管理：进程状态管理、进程调度和分派、创建和撤销进程控制块等。
2. 存储器管理：存储器的空间分配和回收、内存信息保护程序、代码兑换程序等。
3. 设备管理。缓冲区管理，设备分配和回收。

#### 1.3.2 中断和异常的概念

用户程序想从用户态中调用核心态，需要通过中断进行响应切换。某个程序占据的资源的释放需要通过中断实现。

**1. 中断和异常的定义**

中断（Interruption）也称为外中断，来自CPU执行指令外部的事件，通常用于信息输入/输出。

异常（Exception）也称为内中断，是指来自CPU执行指令内部的事件，如程序的非法操作码、地址越界、

运算溢出、虚存系统的缺页及专门的陷入指令等引起的事件。异常不能被屏蔽，需要立即处理。

**2. 中断和异常的分类**

![Interruption](.\System\Interruption.png)

**3. 中断和异常的处理过程**



#### 1.3.3系统调用

系统调用是指用户程序再程序中调用操作系统锁提供的一些子功能，系统调用可以称为的公共子程序。

通常由以下几种分类：

- 设备管理：完成设备的请求或释放，以及设备启动等功能。
- 文件管理：完成文件的读、写、创建和删除等功能。
- 进程控制：完成进程的创建、撤销、阻塞及唤醒功能。
- 进程通信：完成进程之间的消息传递或信号传递等功能。
- 内存管理：完成内存的分配、回收以及获取作业占用内存大小及始地址等功能。

常见的特权指令：

- 对I/O设备操作的指令
- 有关访问程序状态的指令
- 存取特殊寄存器的指令
- 其他指令

用户态转向核心态的例子：

1. 用户程序需要操作系统的服务，即系统调用
2. 发生了一次中断。
3. 用户程序中产生了一个错误状态。
4. 用户程序中企图执行一条特权指令。
5. 从核心态转向用户态由一条指令实现，这条指令也是特权命令，一般是中断返回指令。

若程序的运行由用户态转到核心态，则会用到访管指令，访管指令是再用户态使用的，所以它不可能是特权指令。

#### 1.3.4 习题

**1. 选择题**

1-5：AC**C**C~~C~~D

6-10：D~~C~~ACA**B**

11-15：AC**CD**D

16-20：BA~~A~~C**~~A~~**BB

21-25：**D~~A~~B~~B~~C**AC

26-29：~~A~~DCD**B**



### 1.4 操作系统结构

可以使用分层法将操作系统分成若干层，最底层是硬件，最高层为用户接口，每一层之只能调用紧邻它的低层的功能和服务（类似于网络层次划分一样）

模块化，是将操作系统细分为几个模块

#### 1.4.4 习题

**1. 选择题**

### 1.5 操作系统引导

#### 1.5.4 习题

**1. 选择题**

### 1.6 虚拟机

#### 1.6.1 虚拟机基本概念

#### 1.6.4 习题

**1. 选择题**

## 第2章 进程与线程

### 2.1 进程与线程

### 2.2 处理机调度

### 2.3 同步与互斥

### 2.4 死锁

## 第3章 内存管理

### 3.1 内存管理概念

### 3.2 虚拟内存管理

## 第4章 文件管理

### 4.1 文件系统基础

### 4.2 目录

### 4.3 文件系统



## 第5章 输入/输出管理

### 5.1 I/O管理概述

### 5.2 设备独立性软件

### 5.3磁盘和固态硬盘

